(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){},21:function(e,t,a){e.exports=a(35)},26:function(e,t,a){},27:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),s=a(17),i=a.n(s),r=a(13),o=a(5),c=a(6),u=a(9),m=a(7),h=a(10),f=a(1),p=(a(26),function(e){return l.a.createElement("div",{className:"profile-flex"},l.a.createElement("div",{className:"profile-image"},l.a.createElement("img",{id:"profile-image",src:e.profilePicture,alt:"profile"})),l.a.createElement("div",{className:"profile-info"},l.a.createElement("div",null,e.username),l.a.createElement("div",null,e.usernameShort),l.a.createElement("div",null,"Tweets: ",e.tweetCounter)))}),d=a(18),w=a.n(d),g=(a(27),function(e){return l.a.createElement("li",{className:"list-item"},l.a.createElement("div",{className:"tweet-picture-container"},l.a.createElement("img",{src:e.profilePicture,alt:"profile"})),l.a.createElement("div",{className:"tweet-content"},l.a.createElement("span",{className:"tweet-username"},e.usernameShort),l.a.createElement(w.a,{className:"tweet-time",time:e.timesOfTweet,autoUpdate:!0}),l.a.createElement("p",null,e.tweet)))}),b=(a(16),function(e){return l.a.createElement("div",{className:"tweetbox-container"},l.a.createElement("ul",null,e.tweets.map(function(t,a){return l.a.createElement(g,{key:a,datakey:a,length:e.tweets.length,tweet:t,timesOfTweet:e.timesOfTweets[a],usernameShort:e.usernameShort,profilePicture:e.profilePicture})})))}),v=a(11),E=a.n(v),y=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=E.a.Widget(this.uploader),a=this.props,n=a.value,l=a.onChange,s=a.onUploadComplete;"undefined"!==typeof n&&t.value(n),"function"===typeof l&&t.onChange(function(t){e.files=t?e.files&&e.files.files?e.files.files():[e.files]:null,l(t)}),"function"===typeof s&&t.onUploadComplete(s),t.onDialogOpen(function(t){return e.dialog=t})}},{key:"componentWillUnmount",value:function(){this.dialog&&this.dialog.reject(),this.files&&E.a.jQuery.when.apply(null,this.files).cancel();var e=E.a.jQuery(this.uploader).next(".uploadcare--widget"),t=e.data("uploadcareWidget");t&&t.inputElement===this.uploader&&e.remove()}},{key:"getInputAttributes",value:function(){var e=Object.assign({},this.props);return delete e.value,delete e.onChange,delete e.onUploadComplete,e}},{key:"render",value:function(){var e=this,t=this.getInputAttributes();return l.a.createElement("input",Object.assign({type:"hidden",ref:function(t){return e.uploader=t}},t))}}]),t}(n.Component),O=[],j=function(e){return function(){var t=[],a=[];t.push(e.tweets),t.map(function(e){return e.map(function(e){return e.timesOfTweets.map(function(t,n){return a.push([t,e.tweets[n],e.username,e.profilePicture]),O=a.sort(function(e,t){return t[0]-e[0]})}),null}),null})}(),0!==e.tweets.length?l.a.createElement("div",{className:"tweetbox-container"},l.a.createElement("ul",null,O.map(function(e,t){return l.a.createElement(g,{key:t,usernameShort:"@"+e[2].toLowerCase().replace(/\s/g,""),timesOfTweet:e[0],profilePicture:e[3],tweet:e[1]})}))):null},S=a(20),k=(a(29),function(e){var t=Object(n.useState)(!1),a=Object(S.a)(t,2),s=a[0],i=a[1];return Object(n.useEffect)(function(){!function(){for(var t=0;t<e.following.length;t++){if(e.id===e.following[t].owner_id){i(!0);break}i(!1)}}()},[e.item]),l.a.createElement("div",{className:"search-item-with-button"},l.a.createElement("div",{className:"search-item-container"},l.a.createElement("img",{className:"search-item-img",src:e.item.profilePicture,alt:"profile"}),l.a.createElement("div",{className:"search-item-username"},l.a.createElement("p",null,e.item.username),l.a.createElement("p",null,"@"+e.item.username.toLowerCase().replace(/\s/g,"")),l.a.createElement("p",null,"Tweets: ",e.item.tweets.length))),s?l.a.createElement("button",{className:"unfollow",onClick:function(){e.unfollow(e.item),i(!1)}},"Unfollow"):l.a.createElement("button",{className:"follow",onClick:function(){e.follow(e.item),i(!0)}},"Follow"))}),N=(a(30),function(e){return l.a.createElement("ul",{className:"search-list"},e.searchResultsArray.map(function(t,a){return l.a.createElement("li",{className:"search-list-item",key:a},l.a.createElement(k,{item:t,id:t.owner_id,follow:e.follow,unfollow:e.unfollow,following:e.following}))}))}),C=a(12),P=(a(34),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={profilePicture:"logo.png",username:"",timesOfTweets:[],tweets:[],tweetValue:"",usernameValue:"",search:"",searchEmpty:!0,searchResultsArray:[],following:[],home:!0},a.usernameInput=a.usernameInput.bind(Object(f.a)(Object(f.a)(a))),a.usernameInputKeyHandler=a.usernameInputKeyHandler.bind(Object(f.a)(Object(f.a)(a))),a.handleTweetChange=a.handleTweetChange.bind(Object(f.a)(Object(f.a)(a))),a.handleTweetKeyDown=a.handleTweetKeyDown.bind(Object(f.a)(Object(f.a)(a))),a.post=a.post.bind(Object(f.a)(Object(f.a)(a))),a.updateDb=a.updateDb.bind(Object(f.a)(Object(f.a)(a))),a.uploadPicture=a.uploadPicture.bind(Object(f.a)(Object(f.a)(a))),a.getSearch=a.getSearch.bind(Object(f.a)(Object(f.a)(a))),a.clearSearch=a.clearSearch.bind(Object(f.a)(Object(f.a)(a))),a.searchResults=a.searchResults.bind(Object(f.a)(Object(f.a)(a))),a.follow=a.follow.bind(Object(f.a)(Object(f.a)(a))),a.unfollow=a.unfollow.bind(Object(f.a)(Object(f.a)(a))),a.setIntitalState=a.setIntitalState.bind(Object(f.a)(Object(f.a)(a))),a.client=C.c.initializeDefaultAppClient("twitter-clone-hgeer"),a.db=a.client.getServiceClient(C.b.factory,"mongodb-atlas").db("twitter-clone"),a.user=a.client.auth.loginWithCredential(new C.a),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"usernameInput",value:function(e){this.setState({usernameValue:e.target.value})}},{key:"usernameInputKeyHandler",value:function(e){"Enter"===e.key&&(e.target.value||alert("name can't be empty"),this.setState({username:this.state.usernameValue}))}},{key:"handleTweetChange",value:function(e){this.setState({tweetValue:e.target.value})}},{key:"handleTweetKeyDown",value:function(e){"Enter"===e.key&&this.post()}},{key:"post",value:function(){if(""!==this.state.tweetValue){var e=this.state.tweets,t=this.state.timesOfTweets,a=(new Date).getTime()/1e3;t.unshift(a),e.unshift(this.state.tweetValue),this.setState({tweets:e,timesOfTweets:t,tweetValue:""}),this.updateDb()}}},{key:"updateDb",value:function(){this.db.collection("users").updateOne({owner_id:this.client.auth.user.id},{$set:{profilePicture:this.state.profilePicture,username:this.state.usernameValue||this.state.username,tweets:this.state.tweets,timesOfTweets:this.state.timesOfTweets,following:this.state.following}},{upsert:!0}).catch(function(e){console.error(e)})}},{key:"uploadPicture",value:function(e){this.db.collection("users").updateOne({owner_id:this.client.auth.user.id},{$set:{profilePicture:"https://ucarecdn.com/"+e.uuid+"/-/resize/150x/"}},this.setState({profilePicture:"https://ucarecdn.com/"+e.uuid+"/-/resize/150x/"}),{upsert:!0}).catch(function(e){console.error(e)})}},{key:"getSearch",value:function(e){""!==e.target.value?(this.setState({searchEmpty:!1}),this.searchResults(e.target.value)):this.setState({searchEmpty:!0}),this.setState({search:e.target.value})}},{key:"clearSearch",value:function(){this.setState({searchEmpty:!0,search:""})}},{key:"searchResults",value:function(e){var t=this;this.db.collection("users").find({username:new RegExp(e)}).toArray().then(function(e){e.length>0&&t.setState({searchResultsArray:Object(r.a)(e)}),console.log(e)})}},{key:"follow",value:function(e){var t=this.state.following;t.push(e),this.setState({following:Object(r.a)(t)})}},{key:"unfollow",value:function(e){var t=this.state.following.filter(function(t){return t.owner_id!==e.owner_id});0===t.length&&this.setState({following:[]}),this.setState({following:Object(r.a)(t)})}},{key:"setIntitalState",value:function(){var e=this;this.user.then(function(){return e.db.collection("users").findOne({owner_id:e.client.auth.user.id})}).then(function(t){t&&e.setState({profilePicture:t.profilePicture||"logo.png",tweets:t.tweets,timesOfTweets:t.timesOfTweets,username:t.username,following:t.following||[]})}).catch(function(e){console.error(e)})}},{key:"componentDidMount",value:function(){this.setIntitalState()}},{key:"componentDidUpdate",value:function(e,t){this.state.profilePicture===t.profilePicture&&this.state.tweets===t.tweets&&this.state.username===t.username&&this.state.following===t.following||(console.log("component updated"),this.updateDb())}},{key:"render",value:function(){var e=this;return""===this.state.username?l.a.createElement("div",{className:"login-container animation"},l.a.createElement("div",{className:"logo-container"},l.a.createElement("img",{src:"logo.png",alt:"logo"})),l.a.createElement("p",null,"Welcome to Twudder (like a twitter, but with no annoying tweets)"),l.a.createElement("div",{className:"username-input-container"},l.a.createElement("input",{id:"username-input",type:"text",value:this.state.usernameValue,onChange:this.usernameInput,onKeyDown:this.usernameInputKeyHandler}),l.a.createElement("label",{className:"username-input-label",htmlFor:"username-input"},"Please enter your name and press Enter"))):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"search-container"},l.a.createElement("div",{className:"search-input-container"},l.a.createElement("input",{id:"search",type:"text",value:this.state.search,onChange:this.getSearch,placeholder:"Search..."}),l.a.createElement("button",{onClick:this.clearSearch},"Clear")),this.state.searchEmpty?null:l.a.createElement(N,{searchResultsArray:this.state.searchResultsArray,following:this.state.following,follow:this.follow,unfollow:this.unfollow})),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"profile-container"},l.a.createElement(p,{profilePicture:this.state.profilePicture,username:this.state.username,usernameShort:"@"+this.state.username.toLowerCase().replace(/\s/g,""),tweetCounter:this.state.tweets.length}),l.a.createElement("div",{className:"uploader"},l.a.createElement("label",{htmlFor:"file"},"Change Picture:")," ",l.a.createElement(y,{id:"file",name:"file","data-tabs":"file camera",onChange:function(e){console.log("File changed: ",e),e&&(e.progress(function(e){return console.log("File progress: ",e.progress)}),e.done(function(e){return console.log("File uploaded: ",e)}))},onUploadComplete:function(t){return e.uploadPicture(t)}}))),l.a.createElement("div",{className:"buttons-and-tweets"},l.a.createElement("div",{className:"buttons-container"},l.a.createElement("button",{className:this.state.home?"button --active":"button",onClick:function(){return e.setState({home:!0})}},"Home"),l.a.createElement("button",{className:this.state.home?"button":"button --active",onClick:function(){return e.setState({home:!1})}},"Feed")),l.a.createElement("div",{className:"tweets-container"},l.a.createElement("div",{className:"post-container"},l.a.createElement("input",{id:"post",type:"text",value:this.state.tweetValue,onChange:this.handleTweetChange,onKeyDown:this.handleTweetKeyDown}),l.a.createElement("label",{className:"post-label",htmlFor:"post"},"Please enter your tweet and press Enter")),this.state.home?l.a.createElement(b,{tweets:this.state.tweets,timesOfTweets:this.state.timesOfTweets,profilePicture:this.state.profilePicture,usernameShort:"@"+this.state.username.toLowerCase().replace(/\s/g,"")}):l.a.createElement(j,{tweets:this.state.following})))))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,1,2]]]);
//# sourceMappingURL=main.000099f7.chunk.js.map