(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,n){},26:function(e,t,n){e.exports=n(43)},31:function(e,t,n){},36:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),o=n(23),i=n.n(o),s=n(17),r=n(9),c=n(10),u=n(14),m=n(11),h=n(13),f=n(1),d=(n(31),function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"profile-flex"},l.a.createElement("div",{className:"profile-image"},l.a.createElement("img",{id:"profile-image",src:e.profilePicture,alt:"profile"})),l.a.createElement("div",{className:"profile-info"},l.a.createElement("div",null,e.username),l.a.createElement("div",null,e.usernameShort),l.a.createElement("div",null,"Tweets: ",e.tweetCounter))),l.a.createElement("div",{className:"profile-following"},l.a.createElement("p",null,"Following: "),e.following.map(function(t,n){return l.a.createElement("div",{key:n,className:"profile-following-item"},l.a.createElement("img",{className:"profile-following-image",src:t.profilePicture,alt:"following profile"}),l.a.createElement("p",{className:"profile-following-username"},t.username),l.a.createElement("div",{className:"profile-following-modal"},l.a.createElement("img",{src:t.profilePicture}),l.a.createElement("div",{className:"profile-following-modal-info"},l.a.createElement("p",{className:"profile-following-modal-p"},t.username),l.a.createElement("p",{className:"profile-following-modal-p"}," ","Tweets: ",t.tweets.length),l.a.createElement("button",{className:"profile-following-unfollow",onClick:function(){return e.unfollow(e.following[n])}},"Unfollow"))))})))}),w=n(6),p=n(24),g=n.n(p),b=function(e){return l.a.createElement("p",null,e.comment)},v=n(8),E=n(18),O=n(19);n(36);v.b.add(O.b,O.a);var y=function(e){var t=[];Object(a.useEffect)(function(){var n=[];n[0]=e.tweet;try{t=1===n[0].length?n[0][0].split("&?"):n[0].split("&?")}catch(a){console.log(a)}s(t)},[e.tweet]);var n=Object(a.useState)([]),o=Object(w.a)(n,2),i=o[0],s=o[1],r=Object(a.useState)(!1),c=Object(w.a)(r,2),u=c[0],m=c[1],h=Object(a.useState)(""),f=Object(w.a)(h,2),d=f[0],p=f[1],v=Object(a.useState)(!1),O=Object(w.a)(v,2),y=O[0],j=O[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("li",{className:"list-item"},l.a.createElement("div",{className:"tweet-picture-container"},l.a.createElement("img",{src:e.profilePicture,alt:"profile"})),l.a.createElement("div",{className:"tweet-content"},l.a.createElement("span",{className:"tweet-username"},e.usernameShort),l.a.createElement(g.a,{className:"tweet-time",time:e.timesOfTweet,autoUpdate:!0}),l.a.createElement("p",null,i[0]))),l.a.createElement("div",{className:"comments-input"},l.a.createElement("input",{type:"text",placeholder:"Please enter your comment and press Enter",className:u?"comments-input-open":"comments-input-closed",value:d,onChange:function(e){return p(e.target.value)},onKeyDown:function(t){e.comment(e,d,t.keyCode),13===t.keyCode&&(p(""),j(!0)),setTimeout(function(){j(!1)},2e3)}}),l.a.createElement("div",{className:y?"posted-indicator posted":"posted-indicator not-posted"},l.a.createElement("span",null,"Posted")),u?l.a.createElement("button",{className:"open-comments-button --opened-comments",onClick:function(){return m(!u)}},l.a.createElement(E.a,{icon:"eye-slash",size:"lg"})):l.a.createElement("button",{className:"open-comments-button --closed-comments",onClick:function(){return m(!u)}},l.a.createElement(E.a,{icon:"comments",size:"lg"}))),l.a.createElement("div",{className:u?"comments comments-open":"comments comments-closed"},i.map(function(e,t){return 0===t?null:l.a.createElement("div",{key:t},l.a.createElement(b,{comment:e}))})))},j=(n(22),function(e){return l.a.createElement("div",{className:"tweetbox-container"},l.a.createElement("ul",null,e.tweets.map(function(t,n){return l.a.createElement(y,{key:n,datakey:n,length:e.tweets.length,tweet:t,timesOfTweet:e.timesOfTweets[n],usernameShort:e.usernameShort,profilePicture:e.profilePicture,comment:e.comment,owner_id:e.owner_id})})))}),k=n(15),C=n.n(k),N=function(e){function t(){return Object(r.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=C.a.Widget(this.uploader),n=this.props,a=n.value,l=n.onChange,o=n.onUploadComplete;"undefined"!==typeof a&&t.value(a),"function"===typeof l&&t.onChange(function(t){e.files=t?e.files&&e.files.files?e.files.files():[e.files]:null,l(t)}),"function"===typeof o&&t.onUploadComplete(o),t.onDialogOpen(function(t){return e.dialog=t})}},{key:"componentWillUnmount",value:function(){this.dialog&&this.dialog.reject(),this.files&&C.a.jQuery.when.apply(null,this.files).cancel();var e=C.a.jQuery(this.uploader).next(".uploadcare--widget"),t=e.data("uploadcareWidget");t&&t.inputElement===this.uploader&&e.remove()}},{key:"getInputAttributes",value:function(){var e=Object.assign({},this.props);return delete e.value,delete e.onChange,delete e.onUploadComplete,e}},{key:"render",value:function(){var e=this,t=this.getInputAttributes();return l.a.createElement("input",Object.assign({type:"hidden",ref:function(t){return e.uploader=t}},t))}}]),t}(a.Component),S=[],P=function(e){return function(){var t=[],n=[];t.push(e.tweets),t.map(function(e){return e.map(function(e){return e.timesOfTweets.map(function(t,a){return n.push([t,e.tweets[a],e.username,e.profilePicture,e.owner_id]),S=n.sort(function(e,t){return t[0]-e[0]})}),null}),null})}(),0!==e.tweets.length?l.a.createElement("div",{className:"tweetbox-container"},l.a.createElement("ul",null,S.map(function(t,n){return l.a.createElement(y,{datakey:n,key:n,usernameShort:"@"+t[2].toLowerCase().replace(/\s/g,""),timesOfTweet:t[0],profilePicture:t[3],tweet:t[1],comment:e.comment,owner_id:t[4]})}))):null},_=(n(38),function(e){var t=Object(a.useState)(!1),n=Object(w.a)(t,2),o=n[0],i=n[1];return Object(a.useEffect)(function(){!function(){for(var t=0;t<e.following.length;t++){if(e.id===e.following[t].owner_id){i(!0);break}i(!1)}}()},[e.item]),l.a.createElement("div",{className:"search-item-with-button"},l.a.createElement("div",{className:"search-item-container"},l.a.createElement("img",{className:"search-item-img",src:e.item.profilePicture,alt:"profile"}),l.a.createElement("div",{className:"search-item-username"},l.a.createElement("p",null,e.item.username),l.a.createElement("p",null,"@"+e.item.username.toLowerCase().replace(/\s/g,"")),l.a.createElement("p",null,"Tweets: ",e.item.tweets.length))),o?l.a.createElement("button",{className:"unfollow",onClick:function(){e.unfollow(e.item),i(!1)}},"Unfollow"):l.a.createElement("button",{className:"follow",onClick:function(){e.follow(e.item),i(!0)}},"Follow"))}),T=(n(39),function(e){return l.a.createElement("ul",{className:"search-list"},e.searchResultsArray.map(function(t,n){return l.a.createElement("li",{className:"search-list-item",key:n},l.a.createElement(_,{item:t,id:t.owner_id,follow:e.follow,unfollow:e.unfollow,following:e.following}))}))}),F=n(16),D=(n(42),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={profilePicture:"logo.png",username:"",timesOfTweets:[],tweets:[],tweetValue:"",usernameValue:"",search:"",searchEmpty:!0,searchResultsArray:[],following:[],home:!0,owner_id:""},n.usernameInput=n.usernameInput.bind(Object(f.a)(Object(f.a)(n))),n.usernameInputKeyHandler=n.usernameInputKeyHandler.bind(Object(f.a)(Object(f.a)(n))),n.handleTweetChange=n.handleTweetChange.bind(Object(f.a)(Object(f.a)(n))),n.handleTweetKeyDown=n.handleTweetKeyDown.bind(Object(f.a)(Object(f.a)(n))),n.post=n.post.bind(Object(f.a)(Object(f.a)(n))),n.updateDb=n.updateDb.bind(Object(f.a)(Object(f.a)(n))),n.uploadPicture=n.uploadPicture.bind(Object(f.a)(Object(f.a)(n))),n.getSearch=n.getSearch.bind(Object(f.a)(Object(f.a)(n))),n.clearSearch=n.clearSearch.bind(Object(f.a)(Object(f.a)(n))),n.searchResults=n.searchResults.bind(Object(f.a)(Object(f.a)(n))),n.follow=n.follow.bind(Object(f.a)(Object(f.a)(n))),n.unfollow=n.unfollow.bind(Object(f.a)(Object(f.a)(n))),n.setIntitalState=n.setIntitalState.bind(Object(f.a)(Object(f.a)(n))),n.comment=n.comment.bind(Object(f.a)(Object(f.a)(n))),n.checkForChanges=n.checkForChanges.bind(Object(f.a)(Object(f.a)(n))),n.checkForOwnChanges=n.checkForOwnChanges.bind(Object(f.a)(Object(f.a)(n))),n.client=F.c.initializeDefaultAppClient("twitter-clone-hgeer"),n.db=n.client.getServiceClient(F.b.factory,"mongodb-atlas").db("test"),n.user=n.client.auth.loginWithCredential(new F.a),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"usernameInput",value:function(e){this.setState({usernameValue:e.target.value})}},{key:"usernameInputKeyHandler",value:function(e){"Enter"===e.key&&(e.target.value||alert("name can't be empty"),this.setState({username:this.state.usernameValue}))}},{key:"handleTweetChange",value:function(e){this.setState({tweetValue:e.target.value})}},{key:"handleTweetKeyDown",value:function(e){"Enter"===e.key&&this.post()}},{key:"post",value:function(){if(""!==this.state.tweetValue){var e=this.state.tweets,t=this.state.timesOfTweets,n=(new Date).getTime()/1e3;t.unshift(n),e.unshift(this.state.tweetValue),this.setState({tweets:e,timesOfTweets:t,tweetValue:""}),this.updateDb()}}},{key:"updateDb",value:function(){this.db.collection("test").updateOne({owner_id:this.client.auth.user.id},{$set:{profilePicture:this.state.profilePicture,username:this.state.usernameValue||this.state.username,tweets:this.state.tweets,timesOfTweets:this.state.timesOfTweets,following:this.state.following}},{upsert:!0}).catch(function(e){console.error(e)})}},{key:"uploadPicture",value:function(e){this.db.collection("test").updateOne({owner_id:this.client.auth.user.id},{$set:{profilePicture:"https://ucarecdn.com/"+e.uuid+"/-/resize/150x/"}},this.setState({profilePicture:"https://ucarecdn.com/"+e.uuid+"/-/resize/150x/"}),{upsert:!0}).catch(function(e){console.error(e)})}},{key:"getSearch",value:function(e){""!==e.target.value?(this.setState({searchEmpty:!1}),this.searchResults(e.target.value)):this.setState({searchEmpty:!0}),this.setState({search:e.target.value})}},{key:"clearSearch",value:function(){this.setState({searchEmpty:!0,search:""})}},{key:"searchResults",value:function(e){var t=this;this.db.collection("test").find({username:new RegExp(e)}).toArray().then(function(e){e.length>0&&t.setState({searchResultsArray:Object(s.a)(e)})})}},{key:"follow",value:function(e){var t=this.state.following;t.push(e),this.setState({following:Object(s.a)(t)})}},{key:"unfollow",value:function(e){var t=this.state.following.filter(function(t){return t.owner_id!==e.owner_id});0===t.length&&this.setState({following:[]}),this.setState({following:Object(s.a)(t)})}},{key:"setIntitalState",value:function(){var e=this;this.user.then(function(){return e.db.collection("test").findOne({owner_id:e.client.auth.user.id})}).then(function(t){t&&e.setState({profilePicture:t.profilePicture||"logo.png",tweets:t.tweets,timesOfTweets:t.timesOfTweets,username:t.username,following:t.following||[],owner_id:t.owner_id})}).catch(function(e){console.error(e)})}},{key:"comment",value:function(e,t,n){var a=this;13===n&&""!==t&&this.user.then(function(){return a.db.collection("test").findOne({owner_id:e.owner_id})}).then(function(n){var l=n.timesOfTweets.indexOf(e.timesOfTweet),o=n.tweets;o[l]=o[l]+"&?"+t+" :@"+a.state.username.toLowerCase().replace(/\s/g,""),a.checkForChanges(),a.db.collection("test").updateOne({owner_id:e.owner_id},{$set:{tweets:o}},{upsert:!0}).catch(function(e){console.error(e)}),e.owner_id===a.client.auth.user.id?a.setState({tweets:o}):(a.checkForChanges(),a.updateDb())}).catch(function(e){console.error(e)})}},{key:"checkForChanges",value:function(){for(var e=this,t=[],n=0;n<this.state.following.length;n++)t.push(this.state.following[n].owner_id);this.db.collection("test").find({owner_id:{$in:t}}).toArray().then(function(t){var n=t.sort(function(e,t){return e.owner_id>t.owner_id?1:t.owner_id>e.owner_id?-1:0}),a=e.state.following.sort(function(e,t){return e.owner_id>t.owner_id?1:t.owner_id>e.owner_id?-1:0});try{for(var l=0;l<a.length;l++)for(var o=0;o<n[l].tweets.length;o++)n[l].tweets[o]===a[l].tweets[o]&&n[l].profilePicture===a[l].profilePicture||e.setState({following:n})}catch(i){console.log(i)}})}},{key:"checkForOwnChanges",value:function(){var e=this;this.user.then(function(){return e.db.collection("test").findOne({owner_id:e.client.auth.user.id})}).then(function(t){for(var n=0;n<t.tweets.length&&t.tweets[n]!==e.state.tweets[n];n++)e.setState({tweets:t.tweets})}).catch(function(e){console.error(e)})}},{key:"componentDidMount",value:function(){var e=this;this.setIntitalState(),this.interval=setInterval(function(){return e.checkForChanges()},1e3),this.selfInterval=setInterval(function(){return e.checkForOwnChanges()},1e3)}},{key:"componentDidUpdate",value:function(e,t){this.state.profilePicture===t.profilePicture&&this.state.tweets===t.tweets&&this.state.username===t.username&&this.state.following===t.following&&this.state.home===t.home||(this.checkForChanges(),this.updateDb())}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this;return""===this.state.username?l.a.createElement("div",{className:"login-container animation"},l.a.createElement("div",{className:"logo-container"},l.a.createElement("img",{src:"logo.png",alt:"logo"})),l.a.createElement("p",null,"Welcome to Twudder (like a twitter, but with no annoying tweets)"),l.a.createElement("div",{className:"username-input-container"},l.a.createElement("input",{id:"username-input",type:"text",value:this.state.usernameValue,onChange:this.usernameInput,onKeyDown:this.usernameInputKeyHandler}),l.a.createElement("label",{className:"username-input-label",htmlFor:"username-input"},"Please enter your name and press Enter"))):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"search-container"},l.a.createElement("div",{className:"search-input-container"},l.a.createElement("input",{id:"search",type:"text",value:this.state.search,onChange:this.getSearch,placeholder:"Search..."}),l.a.createElement("button",{onClick:this.clearSearch},"Clear")),this.state.searchEmpty?null:l.a.createElement(T,{searchResultsArray:this.state.searchResultsArray,following:this.state.following,follow:this.follow,unfollow:this.unfollow})),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"profile-container"},l.a.createElement(d,{profilePicture:this.state.profilePicture,username:this.state.username,usernameShort:"@"+this.state.username.toLowerCase().replace(/\s/g,""),tweetCounter:this.state.tweets.length,following:this.state.following,unfollow:this.unfollow}),l.a.createElement("div",{className:"uploader"},l.a.createElement("label",{htmlFor:"file"},"Change Picture:")," ",l.a.createElement(N,{id:"file",name:"file","data-tabs":"file camera",onChange:function(e){console.log("File changed: ",e),e&&(e.progress(function(e){return console.log("File progress: ",e.progress)}),e.done(function(e){return console.log("File uploaded: ",e)}))},onUploadComplete:function(t){return e.uploadPicture(t)}}))),l.a.createElement("div",{className:"buttons-and-tweets"},l.a.createElement("div",{className:"buttons-container"},l.a.createElement("button",{className:this.state.home?"button --active":"button",onClick:function(){return e.setState({home:!0})}},"Home"),l.a.createElement("button",{className:this.state.home?"button":"button --active",onClick:function(){return e.setState({home:!1})}},"Feed")),l.a.createElement("div",{className:"tweets-container"},this.state.home?l.a.createElement("div",{className:"post-container"},l.a.createElement("input",{id:"post",type:"text",value:this.state.tweetValue,onChange:this.handleTweetChange,onKeyDown:this.handleTweetKeyDown}),l.a.createElement("label",{className:"post-label",htmlFor:"post"},"Please enter your tweet and press Enter")):null,this.state.home?l.a.createElement(j,{tweets:this.state.tweets,timesOfTweets:this.state.timesOfTweets,profilePicture:this.state.profilePicture,usernameShort:"@"+this.state.username.toLowerCase().replace(/\s/g,""),comment:this.comment,owner_id:this.state.owner_id}):l.a.createElement(P,{tweets:this.state.following,comment:this.comment})))))}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,1,2]]]);
//# sourceMappingURL=main.41591158.chunk.js.map